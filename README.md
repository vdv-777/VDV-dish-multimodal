________________________________________
# üçΩÔ∏è VDV-dish-multimodal
## –ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç–∏ –±–ª—é–¥ –ø–æ —Ñ–æ—Ç–æ –∏ —Å–æ—Å—Ç–∞–≤—É

–ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç end-to-end pipeline –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç–∏ –±–ª—é–¥ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Å–ø–∏—Å–∫–∞ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –¥–≤–∞ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã: —Ç–æ–ª—å–∫–æ –ø–æ —Ñ–æ—Ç–æ –∏ –ø–æ —Ñ–æ—Ç–æ + –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞–º.
–û–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –Ω–∞—Ö–æ–¥–∏—Ç –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ—Ö–æ–∂–µ–µ –±–ª—é–¥–æ –∏–∑ –±–∞–∑—ã –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –µ–≥–æ –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å, –º–∞—Å—Å—É –∏ —Å–æ—Å—Ç–∞–≤.
________________________________________
## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
VDV-dish-multimodal/
‚îú‚îÄ‚îÄ config.py                 # üß† –ì–ª–∞–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

‚îú‚îÄ‚îÄ dataset.py                # üì¶ –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

‚îú‚îÄ‚îÄ model.py                  # üß¨ –ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

‚îú‚îÄ‚îÄ train.py                  # üèãÔ∏è –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

‚îú‚îÄ‚îÄ inference.py              # üîç –õ–æ–≥–∏–∫–∞ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞

‚îú‚îÄ‚îÄ vdv-dish.ipynb            # üìí –ï–¥–∏–Ω—ã–π –Ω–æ—É—Ç–±—É–∫ –¥–ª—è –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤

‚îú‚îÄ‚îÄ requirements.txt          # ‚öôÔ∏è –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

‚îú‚îÄ‚îÄ data/                     # üóÉÔ∏è –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

‚îÇ   ‚îú‚îÄ‚îÄ ingredients.csv

‚îÇ   ‚îú‚îÄ‚îÄ dish.csv

‚îÇ   ‚îî‚îÄ‚îÄ images/

‚îî‚îÄ‚îÄ runs/                     # üìÅ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
 
‚îÇ   ‚îî‚îÄ‚îÄ  exp_calorie_final/

‚îÇ        ‚îú‚îÄ‚îÄ best_model.pth

‚îÇ        ‚îú‚îÄ‚îÄ inference_bundle.pth

‚îÇ        ‚îî‚îÄ‚îÄ error_analysis.txt

### ‚öôÔ∏è config.py ‚Äî –µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
–í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞ –∑–∞–¥–∞—é—Ç—Å—è –∑–¥–µ—Å—å ‚Äî –æ—Ç –æ–±—É—á–µ–Ω–∏—è –¥–æ –≤—ã–≤–æ–¥–∞.

@dataclass

class Config:

   
    # üóÉÔ∏è –ü—É—Ç–∏ –∫ –¥–∞–Ω–Ω—ã–º
   
    DATA_DIR = "data"
    
    INGREDIENTS_PATH = "data/ingredients.csv"   # –°–ø–∏—Å–æ–∫ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤
    
    DISH_PATH = "data/dish.csv"                 # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –±–ª—é–¥
    
    IMAGES_DIR = "data/images"                  # –§–æ—Ç–æ –æ–±—É—á–∞—é—â–∏—Ö –±–ª—é–¥
    
    # üß¨ –ú–æ–¥–µ–ª—å
    IMAGE_MODEL_NAME = "tf_efficientnet_b0"     # Backbone –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    EMBEDDING_DIM = 128                         # –†–∞–∑–º–µ—Ä —ç–º–±–µ–¥–¥–∏–Ω–≥–∞ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞
    HIDDEN_DIM = 256                            # –†–∞–∑–º–µ—Ä —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–ª–æ—è —Ñ—å—é–∂–Ω–∞
    
    # üèãÔ∏è –û–±—É—á–µ–Ω–∏–µ
    BATCH_SIZE = 16                             # –£–º–µ–Ω—å—à–µ–Ω–æ –¥–ª—è –º–∞–ª–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞
    EPOCHS = 30
    LR = 5e-5                                   # –ù–∏–∑–∫–∏–π LR –¥–ª—è fine-tuning
    WEIGHT_DECAY = 1e-5
    SEED = 42                                   # –î–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏
    
    # üîß Fine-tuning (–∑–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è)
    IMAGE_UNFREEZE_LAYERS = ["blocks.6", "conv_head", "bn2"]  # –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å–ª–æ–∏ EfficientNet
    
    # üìä –î–∞–Ω–Ω—ã–µ
    MAX_INGREDIENTS = 20                        # –ú–∞–∫—Å. —á–∏—Å–ª–æ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤ –Ω–∞ –±–ª—é–¥–æ
    DEBUG = False                               # –†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏
    
    # üíæ –í—ã–≤–æ–¥
    SAVE_DIR = "runs/exp_calorie_final"
    MODEL_SAVE_PATH = "runs/exp_calorie_final/best_model.pth"
    EMBEDDINGS_PATH = "runs/exp_calorie_final/inference_bundle.pth"
________________________________________
### üì¶ dataset.py ‚Äî –∑–∞–≥—Ä—É–∑—á–∏–∫ –¥–∞–Ω–Ω—ã—Ö
* üñºÔ∏è –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–æ—Ç–æ –∏–∑ data/images/{dish_id}/rgb.png (–æ–±—É—á–µ–Ω–∏–µ) –∏–ª–∏ vdv-dish/{dish_number}.png (–∏–Ω—Ñ–µ—Ä–µ–Ω—Å)
* ü•ó –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç ID –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤ –≤ —Å–ø–∏—Å–∫–∏ –Ω–∞–∑–≤–∞–Ω–∏–π
* üîÑ –ü—Ä–∏–º–µ–Ω—è–µ—Ç –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ (—Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏)
* üß™ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç albumentations ‚â•2.0
________________________________________
### üß¨ model.py ‚Äî –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
*	Image encoder: tf_efficientnet_b0
*	Text encoder: –æ–±—É—á–∞–µ–º—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤
*	–§—å—é–∂–Ω: –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è ‚Üí —Ä–µ–≥—Ä–µ—Å—Å–∏—è
*	–í—ã—Ö–æ–¥: –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å + —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
________________________________________
### üèãÔ∏è train.py ‚Äî –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
*	–û–±—É—á–∞–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –∑–∞–¥–∞–Ω–Ω—ã—Ö –≤ –∫–æ–Ω—Ñ–∏–≥–µ
*	–í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ split=="test"
*	–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ª—É—á—à—É—é –º–æ–¥–µ–ª—å –ø–æ Val MAE
*	–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç DEBUG-—Ä–µ–∂–∏–º
________________________________________
### üîç inference.py ‚Äî –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π –∏–Ω—Ñ–µ—Ä–µ–Ω—Å
*	–ó–∞–≥—Ä—É–∂–∞–µ—Ç inference_bundle.pth ‚Äî –Ω–µ —Ç—Ä–µ–±—É–µ—Ç data/images/
*	–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ —Ä–µ–∂–∏–º–∞ —á–µ—Ä–µ–∑ cfg.INFERENCE_MODE "multimodal" –∏–ª–∏ "image_only"
*	–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: matched_dish_id, –í–µ—Å, –ö–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å, –ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã
________________________________________
### üìä analyze_errors.py ‚Äî –∞–Ω–∞–ª–∏–∑ –∫–∞—á–µ—Å—Ç–≤–∞
*	–û—Ü–µ–Ω–∏–≤–∞–µ—Ç –º–æ–¥–µ–ª—å –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–µ 
*	–§–æ—Ä–º–∏—Ä—É–µ—Ç —Ç–æ–ø-K —Ö—É–¥—à–∏—Ö –∏ –ª—É—á—à–∏—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é K=5)
*	–î–ª—è –∫–∞–∂–¥–æ–≥–æ –±–ª—é–¥–∞ –≤—ã–≤–æ–¥–∏—Ç:
o	dish_id
o	–∏—Å—Ç–∏–Ω–Ω—É—é –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—É—é –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å
o	–ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤
*	–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –æ—Ç—á—ë—Ç –≤ runs/.../error_analysis.txt
‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä TOP_K –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ –∫–æ–¥–µ —Å–∫—Ä–∏–ø—Ç–∞.
________________________________________
### üìí vdv-dish.ipynb ‚Äî –µ–¥–∏–Ω—ã–π —Ä–∞–±–æ—á–∏–π –Ω–æ—É—Ç–±—É–∫
–û–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ —ç—Ç–∞–ø—ã –≤—ã—à–µ –≤ 5 –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –±–ª–æ–∫–æ–≤.
________________________________________
## üß≠ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### ‚òÅÔ∏è –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –í–ú –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

**1) –°–∫–∞—á–∏–≤–∞–µ–º –¥–∞—Ç–∞—Å–µ—Ç**
https://www.kaggle.com/datasets/richardradli/ogyeiv2/data

**2) –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Python-3.10.12**
wget https://www.python.org/ftp/python/3.10.12/Python-3.10.12.tgz
tar -xf Python-3.10.12.tgz
cd Python-3.10.12

./configure --enable-optimizations
make -j$(nproc)
sudo make altinstall

python3.10 --version

python3.10 -m venv p310p2

source mp310p2/bin/activate

**3) –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –≤–∫–ª—é—á–∞—è ipykernel –∏ jupyterlab**
pip3 install -r requirements.txt

–ü—Ä–∏ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏ –±–µ–∑ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –í–ú - –ø—É–Ω–∫—Ç—ã 4-7 –º–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å.

**4) –ü—Ä–∏ –≥–ª–æ–±–∞–ª—å–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–µ –ø–∞–∫–µ—Ç–æ–≤ –±–µ–∑ sudo - —Å–æ—Ö—Ä–∞–Ω—è–µ–º –ø—É—Ç—å –∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º –ø–∞–∫–µ—Ç–∞–º –≤ path ( —á—Ç–æ–±—ã python –º–æ–≥ —É—Å–ø–µ—à–Ω–æ –Ω–∞–π—Ç–∏ –≤—Å–µ –Ω–∞—à–∏ –ø–∞–∫–µ—Ç—ã)**

export PATH="$HOME/.local/bin:$PATH"

echo 'export PATH="$HOME/.local/bin:$PATH"' >> ~/.bashrc

**5) –ó–∞–ø—É—Å–∫–∞–µ–º –Ω–∞ –ª–æ–∫–∞–ª—Ö–æ—Å—Ç–µ —Å–µ—Ä–≤–µ—Ä jupyterlab**

jupyter-lab --ip=0.0.0.0 --port=8888 --no-browser --allow-root
[I 2025-11-17 14:57:40.023 ServerApp]     http://127.0.0.1:8888/lab?token=your_token_here

**6) –û—Ç–∫—Ä—ã–≤–∞–µ–º –ø–æ—Ä—Ç—ã –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ jupyterlab —á–µ—Ä–µ–∑ –æ–±—Ä–∞—Ç–Ω—ã–π –ø–æ—Ä—Ç—Ñ–æ—Ä–≤–∞—Ä–¥–∏–Ω–≥**
### –ù–∞ Windows (–≤ PowerShell –∏–ª–∏ CMD)
ssh -L 8888:localhost:8888 vdv777@158.160.154.189

**7) –û—Ç–∫—Ä—ã–≤–∞–µ–º jupyterlab –≤ –±—Ä–∞—É–∑–µ—Ä–µ, –∞–≤—Ç–æ—Ä–∏–∑—É–µ–º—Å—è –ø–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–º—É —Ç–æ–∫–µ–Ω—É**
http://localhost:8888
**8) –ú–æ–∂–Ω–æ –ø—Ä–∏—Å—Ç—É–ø–∞—Ç—å –∫ –∑–∞–ø—É—Å–∫—É –Ω–æ—É—Ç–±—É–∫–æ–≤ –Ω–∞ –í–ú —Å jupyterlab.**

### üîπ –ë–ª–æ–∫ 1: EDA (–†–∞–∑–≤–µ–¥–æ—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑)
1.	–ó–∞–ø—É—Å—Ç–∏—Ç–µ —è—á–µ–π–∫—É ‚Äî –æ—Ç–æ–±—Ä–∞–∑—è—Ç—Å—è:
o	–ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç–∏
o	–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —á–∏—Å–ª–∞ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤ –Ω–∞ –±–ª—é–¥–æ
o	–¢–æ–ø-20 —Å–∞–º—ã—Ö —á–∞—Å—Ç—ã—Ö –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤
2.	–¶–µ–ª—å: –ø–æ–Ω—è—Ç—å, –Ω—É–∂–Ω—ã –ª–∏ –ª–æ–≥-—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏, –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å MAX_INGREDIENTS.
________________________________________
### üîπ –ë–ª–æ–∫ 2: –û–±—É—á–µ–Ω–∏–µ
1.	–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ cfg.DEBUG = False (–∏–ª–∏ True –¥–ª—è —Ç–µ—Å—Ç–∞).
2.	–ó–∞–ø—É—Å—Ç–∏—Ç–µ —è—á–µ–π–∫—É ‚Äî –Ω–∞—á–Ω—ë—Ç—Å—è –æ–±—É—á–µ–Ω–∏–µ.
3.	–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:
o	–õ—É—á—à–∞—è –º–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ runs/.../best_model.pth
o	–í—ã–≤–µ–¥—ë—Ç—Å—è Val MAE
________________________________________
### üîπ –ë–ª–æ–∫ 3: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
1.	–ó–∞–ø—É—Å—Ç–∏—Ç–µ —è—á–µ–π–∫—É ‚Äî –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è —Å–∫—Ä–∏–ø—Ç save_inference_bundle.py.
2.	–ë—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω —Ñ–∞–π–ª inference_bundle.pth —Å –¥–≤—É–º—è —Ç–∏–ø–∞–º–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤:
o	image_embeddings (256D) ‚Äî –¥–ª—è —Ä–µ–∂–∏–º–∞ image_only
o	multimodal_embeddings (512D) ‚Äî –¥–ª—è —Ä–µ–∂–∏–º–∞ multimodal
3.	–¢–µ–ø–µ—Ä—å –ø–∞–ø–∫—É data/images/ –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å ‚Äî –∏–Ω—Ñ–µ—Ä–µ–Ω—Å –±–æ–ª—å—à–µ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–µ—ë.
________________________________________
### üîπ –ë–ª–æ–∫ 4: –ò–Ω—Ñ–µ—Ä–µ–Ω—Å
1.	–ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –ø–∞–ø–∫—É vdv-dish/:
o	dish.csv —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏ dish_number (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) –∏ ingredients (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
o	–§–æ—Ç–æ: 1.png, 2.png, ...
2.	–í –Ω–æ—É—Ç–±—É–∫–µ —É–∫–∞–∂–∏—Ç–µ —Ä–µ–∂–∏–º:
‚Äòcfg.INFERENCE_MODE = "multimodal"   # "image_only" –∏–ª–∏ "multimodal"‚Äô
 
3.	–ó–∞–ø—É—Å—Ç–∏—Ç–µ —è—á–µ–π–∫—É ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ vdv-dish/predictions.csv.
‚úÖ –î–∞–∂–µ –≤ —Ä–µ–∂–∏–º–µ image_only —Ñ–∞–π–ª dish.csv –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å dish_number.
________________________________________
### üîπ –ë–ª–æ–∫ 5: –ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫
1.	–ó–∞–ø—É—Å—Ç–∏—Ç–µ —è—á–µ–π–∫—É ‚Äî –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è analyze_errors.py.
2.	–í –≤—ã–≤–æ–¥–µ –ø–æ—è–≤—è—Ç—Å—è:
o	–¢–æ–ø-K —Ö—É–¥—à–∏—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é K=5)
o	–¢–æ–ø-K –ª—É—á—à–∏—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
o	–î–ª—è –∫–∞–∂–¥–æ–≥–æ ‚Äî dish_id –∏ –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤
3.	–ü–æ–ª–Ω—ã–π –æ—Ç—á—ë—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ runs/.../error_analysis.txt.
‚öôÔ∏è –ß—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å K, –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é TOP_K = 5 –≤ –∫–æ–¥–µ —è—á–µ–π–∫–∏.
________________________________________
## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è (30 —ç–ø–æ—Ö)
*	Val MAE: 105.05

### üìâ –¢–æ–ø-5 —Ö—É–¥—à–∏—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π

üîç –¢–û–ü-5 –ë–õ–Æ–î –° –ù–ê–ò–ë–û–õ–¨–®–ï–ô –û–®–ò–ë–ö–û–ô –ü–†–ï–î–°–ö–ê–ó–ê–ù–ò–Ø


1. dish_id: dish_1566328776
   –ò—Å—Ç–∏–Ω–∞:   901.8 –∫–∫–∞–ª | –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ:   280.1 –∫–∫–∞–ª | –û—à–∏–±–∫–∞:   621.7 –∫–∫–∞–ª
   –ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã: chicken, cherry tomatoes, pizza

2. dish_id: dish_1563478751
   –ò—Å—Ç–∏–Ω–∞:   950.4 –∫–∫–∞–ª | –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ:   331.3 –∫–∫–∞–ª | –û—à–∏–±–∫–∞:   619.1 –∫–∫–∞–ª
   –ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã: cream, mushroom, spinach (raw), olive oil, pasta, beef, wine, garlic, sour cream, onions, thyme, salt

3. dish_id: dish_1561577947
   –ò—Å—Ç–∏–Ω–∞:   623.2 –∫–∫–∞–ª | –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ:    66.0 –∫–∫–∞–ª | –û—à–∏–±–∫–∞:   557.2 –∫–∫–∞–ª
   –ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã: olive oil, basil, arugula, blueberries, vinegar, mustard, walnuts, white wine, salt, rosemary, oregano, cream, mushroom, wheat berry, chard, pepper, chicken, shallots, garlic, butter, lemon juice, thyme

4. dish_id: dish_1566328805
   –ò—Å—Ç–∏–Ω–∞:   927.8 –∫–∫–∞–ª | –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ:   384.4 –∫–∫–∞–ª | –û—à–∏–±–∫–∞:   543.4 –∫–∫–∞–ª
   –ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã: cherry tomatoes, pizza, chicken, pineapple

5. dish_id: dish_1558720236
   –ò—Å—Ç–∏–Ω–∞:   887.8 –∫–∫–∞–ª | –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ:   353.2 –∫–∫–∞–ª | –û—à–∏–±–∫–∞:   534.7 –∫–∫–∞–ª
   –ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã: apple, carrot, cauliflower, almonds



### üìà –¢–æ–ø-5 –ª—É—á—à–∏—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π

‚úÖ –¢–û–ü-5 –ë–õ–Æ–î –° –ù–ê–ò–õ–£–ß–®–ò–ú –ü–†–ï–î–°–ö–ê–ó–ê–ù–ò–ï–ú


1. dish_id: dish_1564675380
   –ò—Å—Ç–∏–Ω–∞:    87.3 –∫–∫–∞–ª | –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ:    87.3 –∫–∫–∞–ª | –û—à–∏–±–∫–∞:     0.1 –∫–∫–∞–ª
   –ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã: turkey bacon

2. dish_id: dish_1563996509
   –ò—Å—Ç–∏–Ω–∞:   365.2 –∫–∫–∞–ª | –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ:   365.6 –∫–∫–∞–ª | –û—à–∏–±–∫–∞:     0.5 –∫–∫–∞–ª
   –ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã: walnuts, cauliflower, oregano, arugula, mushroom, chard, wheat berry, garlic, shallots, thyme, cream, mustard, rosemary, white wine, chicken, pepper, vinegar, olive oil, blueberries, lemon juice, basil, salt, butter, roasted potatoes

3. dish_id: dish_1558720097
   –ò—Å—Ç–∏–Ω–∞:    30.3 –∫–∫–∞–ª | –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ:    29.8 –∫–∫–∞–ª | –û—à–∏–±–∫–∞:     0.5 –∫–∫–∞–ª
   –ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã: carrot

4. dish_id: dish_1561393715
   –ò—Å—Ç–∏–Ω–∞:    17.1 –∫–∫–∞–ª | –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ:    16.2 –∫–∫–∞–ª | –û—à–∏–±–∫–∞:     0.9 –∫–∫–∞–ª
   –ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã: broccoli

5. dish_id: dish_1559841979
   –ò—Å—Ç–∏–Ω–∞:    39.3 –∫–∫–∞–ª | –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ:    40.4 –∫–∫–∞–ª | –û—à–∏–±–∫–∞:     1.1 –∫–∫–∞–ª
   –ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã: broccoli, mandarin oranges

### üí° –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
–¢–µ–∫—É—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (MAE ‚âà 105 –∫–∫–∞–ª) ‚Äî —Ö–æ—Ä–æ—à–∏–π –¥–ª—è –¥–∞—Ç–∞—Å–µ—Ç–∞ –∏–∑ ~3000 –±–ª—é–¥.
–û–¥–Ω–∞–∫–æ, —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ–¥–æ–æ—Ü–µ–Ω–∫–∞ –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç–∏ –ø–∏—Ü—Ü—ã —Å –∫—É—Ä–∏—Ü–µ–π –Ω–∞ 600+ –∫–∫–∞–ª) —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:
## üîß –ö–∞–∫ –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ —É–ª—É—á—à–∏—Ç—å –º–æ–¥–µ–ª—å (–¥–ª—è —Å–µ—Ä–≤–∏—Å–∞):
1.	–î–æ–±–∞–≤–∏—Ç—å –º–∞—Å—Å—É –∫–∞–∂–¥–æ–≥–æ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞
‚Üí –°–µ–π—á–∞—Å –º–æ–¥–µ–ª—å –∑–Ω–∞–µ—Ç —á—Ç–æ –≤ –±–ª—é–¥–µ, –Ω–æ –Ω–µ —Å–∫–æ–ª—å–∫–æ. –≠—Ç–æ –≥–ª–∞–≤–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –æ—à–∏–±–∫–∏.
2.	–°–æ–±—Ä–∞—Ç—å –º—É–ª—å—Ç–∏—Ñ–æ—Ç–æ –Ω–∞ –±–ª—é–¥–æ
‚Üí –†–∞–∑–Ω—ã–µ —É–≥–ª—ã, –æ—Å–≤–µ—â–µ–Ω–∏–µ ‚Üí —É–ª—É—á—à–∏—Ç –≤–∏–∑—É–∞–ª—å–Ω—É—é —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å.

3.	–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã —Å –æ–±–æ–≥–∞—â–µ–Ω–∏–µ–º –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ –∏ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–∏–µ–º
‚Üí –ü—Ä–µ–¥–æ–±—É—á–µ–Ω–∏–µ –Ω–∞ Food101/Recipe1M+ –º–æ–∂–µ—Ç —Å–∏–ª—å–Ω–æ —É–ª—É—á—à–∏—Ç—å –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –µ–¥—ã –∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–∞–∑–ª–∏—á–Ω–æ–≥–æ —Ä–æ–¥–∞ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤ –≤ —Ä–∞–∑–Ω—ã—Ö –≤–∞—Ä–∏–∞—Ü–∏—è—Ö —Ñ—Ä–∞–∫—Ü–∏–π, —Ç–µ—Ä–º–æ–æ–±—Ä–∞–±–æ—Ç–∫–∏, –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ü–∏–π –∏—Ç–¥.

